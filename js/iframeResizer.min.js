!function(e){"use strict";function n(e,n,i){"addEventListener"in window?e.addEventListener(n,i,!1):"attachEvent"in window&&e.attachEvent("on"+n,i)}function i(e,n,i){"removeEventListener"in window?e.removeEventListener(n,i,!1):"detachEvent"in window&&e.detachEvent("on"+n,i)}function t(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!A;e+=1)A=window[n[e]+"RequestAnimationFrame"];A||c("setup","RequestAnimationFrame not supported")}function o(e){var n="Host page: "+e;return window.top!==window.self&&(n=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e),n}function r(e){return P+"["+o(e)+"]"}function a(e){return L[e]?L[e].log:T}function c(e,n){f("log",e,n,a(e))}function u(e,n){f("info",e,n,a(e))}function s(e,n){f("warn",e,n,!0)}function f(e,n,i,t){!0===t&&"object"==typeof window.console&&console[e](r(n),i)}function d(e){function t(){function e(){b(N),w(A),C("resizedCallback",N)}o("Height"),o("Width"),y(e,N,"init")}function o(e){var n=Number(L[A]["max"+e]),i=Number(L[A]["min"+e]),t=e.toLowerCase(),o=Number(N[t]);c(A,"Checking "+t+" is in range "+i+"-"+n),i>o&&(o=i,c(A,"Set "+t+" to min value")),o>n&&(o=n,c(A,"Set "+t+" to max value")),N[t]=""+o}function r(e){return T.substr(T.indexOf(":")+W+e)}function a(e){c(A,"MessageCallback passed: {iframe: "+N.iframe.id+", message: "+e+"}"),C("messageCallback",{iframe:N.iframe,message:JSON.parse(e)}),c(A,"--")}function f(){var e=document.body.getBoundingClientRect(),n=N.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})}function d(e,n){function i(){v("Send Page Info","pageInfo:"+f(),e,n)}I(i,32)}function F(){function e(e,n){function i(){L[o]?d(L[o].iframe,o):t()}["scroll","resize"].forEach(function(t){c(o,e+t+" listener for sendPageInfo"),n(window,t,i)})}function t(){e("Remove ",i)}var o=A;(function(){e("Add ",n)})(),L[o].stopPageInfo=t}function x(){L[A]&&L[A].stopPageInfo&&(L[A].stopPageInfo(),delete L[A].stopPageInfo)}function M(e){var n=e.getBoundingClientRect();return g(A),{x:Math.floor(Number(n.left)+Number(S.x)),y:Math.floor(Number(n.top)+Number(S.y))}}function z(e){var n=e?M(N.iframe):{x:0,y:0},i=function(){return{x:Number(N.width)+n.x,y:Number(N.height)+n.y}}();c(A,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?function(){window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):s(A,"Unable to scroll to requested position, window.parentIFrame not found")}():function(){S=i,R(),c(A,"--")}()}function R(){!1!==C("scrollCallback",S)?w(A):h()}function E(e){var n=e.split("#")[1]||"",i=decodeURIComponent(n),t=document.getElementById(i)||document.getElementsByName(i)[0];t?function(){var e=M(t);c(A,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y),S={x:e.x,y:e.y},R(),c(A,"--")}():window.top!==window.self?function(){window.parentIFrame?window.parentIFrame.moveToAnchor(n):c(A,"In page link #"+n+" not found and window.parentIFrame not found")}():c(A,"In page link #"+n+" not found")}function C(e,n){return l(A,e,n)}function O(){L[A].firstRun=!1}var T=e.data,N={},A=null;"[iFrameResizerChild]Ready"===T?function(){for(var e in L)v("iFrame requested init",k(e),document.getElementById(e),e)}():function(){return P===(""+T).substr(0,H)&&T.substr(H).split(":")[0]in L}()?(N=function(){var e=T.substr(H).split(":");return{iframe:L[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}(),A=B=N.id,L[A].loaded=!0,!function(){var e=N.type in{true:1,false:1,undefined:1};return e&&c(A,"Ignoring init message from meta parent page"),e}()&&function(e){var n=!0;return L[e]||(n=!1,s(N.type+" No settings for "+e+". Message was: "+T)),n}(A)&&(c(A,"Received: "+T),function(){var e=!0;return null===N.iframe&&(s(A,"IFrame ("+N.id+") not found"),e=!1),e}()&&function(){var n=e.origin,i=L[A].checkOrigin;if(i&&""+n!="null"&&!function(){return i.constructor===Array?function(){var e=0,t=!1;for(c(A,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===n){t=!0;break}return t}():function(){var e=L[A].remoteHost;return c(A,"Checking connection is from: "+e),n===e}()}())throw new Error("Unexpected message received from: "+n+" for "+N.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(L[A].firstRun&&O(),N.type){case"close":m(N.iframe);break;case"message":a(r(6));break;case"scrollTo":z(!1);break;case"scrollToOffset":z(!0);break;case"pageInfo":d(L[A].iframe,A),F();break;case"pageInfoStop":x();break;case"inPageLink":E(r(9));break;case"reset":p(N);break;case"init":t(),C("initCallback",N.iframe);break;default:t()}}())):u(A,"Ignored: "+T)}function l(e,n,i){var t=null,o=null;if(L[e]){if("function"!=typeof(t=L[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function m(e){var n=e.id;c(n,"Removing iFrame: "+n),e.parentNode&&e.parentNode.removeChild(e),l(n,"closedCallback",n),c(n,"--"),delete L[n]}function g(n){null===S&&(S={x:window.pageXOffset!==e?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==e?window.pageYOffset:document.documentElement.scrollTop},c(n,"Get page position: "+S.x+","+S.y))}function w(e){null!==S&&(window.scrollTo(S.x,S.y),c(e,"Set page position: "+S.x+","+S.y),h())}function h(){S=null}function p(e){function n(){b(e),v("reset","reset",e.iframe,e.id)}c(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),g(e.id),y(n,e,"reset")}function b(e){function n(n){e.iframe.style[n]=e[n]+"px",c(e.id,"IFrame ("+o+") "+n+" set to "+e[n]+"px")}function i(n){N||"0"!==e[n]||(N=!0,c(o,"Hidden iFrame detected, creating visibility listener"),x())}function t(e){n(e),i(e)}var o=e.iframe.id;L[o]&&(L[o].sizeHeight&&t("height"),L[o].sizeWidth&&t("width"))}function y(e,n,i){i!==n.type&&A?(c(n.id,"Requesting animation frame"),A(e)):e()}function v(e,n,i,t,o){function r(){var o=L[t].targetOrigin;c(t,"["+e+"] Sending msg to iframe["+t+"] ("+n+") targetOrigin: "+o),i.contentWindow.postMessage(P+n,o)}function a(){s(t,"["+e+"] IFrame("+t+") not found")}var u=!1;t=t||i.id,L[t]&&(function(){i&&"contentWindow"in i&&null!==i.contentWindow?r():a()}(),function(){function e(){!L[t]||L[t].loaded||u||(u=!0,s(t,"IFrame has not responded within "+L[t].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}o&&L[t].warningTimeout&&(L[t].msgTimeout=setTimeout(e,L[t].warningTimeout))}())}function k(e){return e+":"+L[e].bodyMarginV1+":"+L[e].sizeWidth+":"+L[e].log+":"+L[e].interval+":"+L[e].enablePublicMethods+":"+L[e].autoResize+":"+L[e].bodyMargin+":"+L[e].heightCalculationMethod+":"+L[e].bodyBackground+":"+L[e].bodyPadding+":"+L[e].tolerance+":"+L[e].inPageLinks+":"+L[e].resizeFrom+":"+L[e].widthCalculationMethod}function F(i,t){function o(){var e=t&&t.id||V.id+O++;return null!==document.getElementById(e)&&(e+=O++),e}function r(){var e=L[d].firstRun,n=L[d].heightCalculationMethod in j;!e&&n&&p({iframe:i,height:0,width:0,type:"init"})}function a(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}function u(e){for(var n in V)V.hasOwnProperty(n)&&(L[d][n]=e.hasOwnProperty(n)?e[n]:V[n])}function f(e){return""===e||"file://"===e?"*":e}var d=function(e){return B=e,""===e&&(i.id=e=o(),T=(t||{}).log,B=e,c(e,"Added missing iframe ID: "+e+" ("+i.src+")")),e}(i.id);!function(){return d in L&&"iFrameResizer"in i}()?(function(e){e=e||{},L[d]={firstRun:!0,iframe:i,remoteHost:i.src.split("/").slice(0,3).join("/")},a(e),u(e),L[d].targetOrigin=!0===L[d].checkOrigin?f(L[d].remoteHost):"*"}(t),function(){switch(c(d,"IFrame scrolling "+(L[d].scrolling?"enabled":"disabled")+" for "+d),i.style.overflow=!1===L[d].scrolling?"hidden":"auto",L[d].scrolling){case!0:i.scrolling="yes";break;case!1:i.scrolling="no";break;default:i.scrolling=L[d].scrolling}}(),function(){function e(e){1/0!==L[d][e]&&0!==L[d][e]&&(i.style[e]=L[d][e]+"px",c(d,"Set "+e+" = "+L[d][e]+"px"))}function n(e){if(L[d]["min"+e]>L[d]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}(),function(){("number"==typeof L[d].bodyMargin||"0"===L[d].bodyMargin)&&(L[d].bodyMarginV1=L[d].bodyMargin,L[d].bodyMargin=L[d].bodyMargin+"px")}(),function(t){function o(){v("iFrame.onload",t,i,e,!0),r()}n(i,"load",o),v("init",t,i,e,!0)}(k(d)),function(){Function.prototype.bind&&(L[d].iframe.iFrameResizer={close:m.bind(null,L[d].iframe),resize:v.bind(null,"Window resize","resize",L[d].iframe),moveToAnchor:function(e){v("Move to anchor","moveToAnchor:"+e,L[d].iframe,d)},sendMessage:function(e){v("Send Message","message:"+(e=JSON.stringify(e)),L[d].iframe,d)}})}()):s(d,"Ignored iFrame, already setup.")}function I(e,n){null===q&&(q=setTimeout(function(){q=null,e()},n))}function x(){function e(){for(var e in L)!function(e){function n(n){return"0px"===L[e].iframe.style[n]}(function(e){return null!==e.offsetParent})(L[e].iframe)&&(n("height")||n("width"))&&v("Visibility change","resize",L[e].iframe,e)}(e)}function n(n){c("window","Mutation observed: "+n[0].target+" "+n[0].type),I(e,16)}var i=window.MutationObserver||window.WebKitMutationObserver;i&&function(){var e=document.querySelector("body"),t={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};new i(n).observe(e,t)}()}function M(e){function n(){R("Window "+e,"resize")}c("window","Trigger event: "+e),I(n,16)}function z(){function e(){R("Tab Visable","resize")}"hidden"!==document.visibilityState&&(c("document","Trigger event: Visiblity change"),I(e,16))}function R(e,n){for(var i in L)(function(e){return"parent"===L[e].resizeFrom&&L[e].autoResize&&!L[e].firstRun})(i)&&v(e,n,document.getElementById(i),i)}function E(){n(window,"message",d),n(window,"resize",function(){M("resize")}),n(document,"visibilitychange",z),n(document,"-webkit-visibilitychange",z),n(window,"focusin",function(){M("focus")}),n(window,"focus",function(){M("focus")})}function C(){function n(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),F(n,e),o.push(n))}function i(e){e&&e.enablePublicMethods&&s("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}var o;return t(),E(),function(t,r){switch(o=[],i(t),typeof r){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(r||"iframe"),n.bind(e,t));break;case"object":n(t,r);break;default:throw new TypeError("Unexpected data type ("+typeof r+")")}return o}}if("undefined"!=typeof window){var O=0,T=!1,N=!1,W="message".length,P="[iFrameSizer]",H=P.length,S=null,A=window.requestAnimationFrame,j={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},L={},q=null,B="Host Page",V={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){s("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};window.jQuery&&function(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){function n(n,i){F(i,e)}return this.filter("iframe").each(n).end()}):u("","Unable to bind to jQuery, it is not fully loaded.")}(window.jQuery),"function"==typeof define&&define.amd?define([],C):"object"==typeof module&&"object"==typeof module.exports?module.exports=C():window.iFrameResize=window.iFrameResize||C()}}();